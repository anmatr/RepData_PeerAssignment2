<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>1. Synopsis</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h3>1. Synopsis</h3>

<p>The U.S. National Oceanic and Athmospheric Administration&#39;s (NOAA) storm database tracks characteristics of major storms and weather events in the United States, including estimates of any fatalities, injuries and property damage. This database is used in this analysis to give a basic overview on this two questions:</p>

<ol>
<li><p>Across the United States, which types of events (as indicated in the EVTYPE variable) are most harmful with respect to population health?</p></li>
<li><p>Across the United States, which types of events have the greatest economic consequences?</p></li>
</ol>

<p>The database can be downloaded from this location: <a href="https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2">Storm Data</a>.</p>

<p>There is also some documentation of the database available:</p>

<ul>
<li><p>National Weather Service <a href="https://d396qusza40orc.cloudfront.net/repdata%2Fpeer2_doc%2Fpd01016005curr.pdf">Storm Data Documentation</a></p></li>
<li><p>National Climatic Data Center <a href="https://d396qusza40orc.cloudfront.net/repdata%2Fpeer2_doc%2FNCDC%20Storm%20Events-FAQ%20Page.pdf">Storm Events FAQ</a></p></li>
</ul>

<h3>2. Data Processing</h3>

<p>Loading necessary libraries:</p>

<pre><code class="r">library(dplyr)
library(lubridate)
library(ggplot2)
library(knitr)
library(RColorBrewer)
</code></pre>

<h4>2.1 Read the storm database</h4>

<p>After downloading the database the document can be loaded with the following command.</p>

<pre><code class="r">storm &lt;- read.csv(bzfile(&quot;repdata_data_StormData.csv.bz2&quot;))
</code></pre>

<p>The number of rows loaded from the storm database is 902,397 and the first few lines are displayed below.</p>

<pre><code class="r">dim(storm)
</code></pre>

<pre><code>## [1] 902297     37
</code></pre>

<pre><code class="r">head(storm)
</code></pre>

<pre><code>##   STATE__           BGN_DATE BGN_TIME TIME_ZONE COUNTY COUNTYNAME STATE
## 1       1  4/18/1950 0:00:00     0130       CST     97     MOBILE    AL
## 2       1  4/18/1950 0:00:00     0145       CST      3    BALDWIN    AL
## 3       1  2/20/1951 0:00:00     1600       CST     57    FAYETTE    AL
## 4       1   6/8/1951 0:00:00     0900       CST     89    MADISON    AL
## 5       1 11/15/1951 0:00:00     1500       CST     43    CULLMAN    AL
## 6       1 11/15/1951 0:00:00     2000       CST     77 LAUDERDALE    AL
##    EVTYPE BGN_RANGE BGN_AZI BGN_LOCATI END_DATE END_TIME COUNTY_END
## 1 TORNADO         0                                               0
## 2 TORNADO         0                                               0
## 3 TORNADO         0                                               0
## 4 TORNADO         0                                               0
## 5 TORNADO         0                                               0
## 6 TORNADO         0                                               0
##   COUNTYENDN END_RANGE END_AZI END_LOCATI LENGTH WIDTH F MAG FATALITIES
## 1         NA         0                      14.0   100 3   0          0
## 2         NA         0                       2.0   150 2   0          0
## 3         NA         0                       0.1   123 2   0          0
## 4         NA         0                       0.0   100 2   0          0
## 5         NA         0                       0.0   150 2   0          0
## 6         NA         0                       1.5   177 2   0          0
##   INJURIES PROPDMG PROPDMGEXP CROPDMG CROPDMGEXP WFO STATEOFFIC ZONENAMES
## 1       15    25.0          K       0                                    
## 2        0     2.5          K       0                                    
## 3        2    25.0          K       0                                    
## 4        2     2.5          K       0                                    
## 5        2     2.5          K       0                                    
## 6        6     2.5          K       0                                    
##   LATITUDE LONGITUDE LATITUDE_E LONGITUDE_ REMARKS REFNUM
## 1     3040      8812       3051       8806              1
## 2     3042      8755          0          0              2
## 3     3340      8742          0          0              3
## 4     3458      8626          0          0              4
## 5     3412      8642          0          0              5
## 6     3450      8748          0          0              6
</code></pre>

<p>The columns we are interested in for this analysis are as follows:</p>

<table><thead>
<tr>
<th>Column</th>
<th>Content</th>
</tr>
</thead><tbody>
<tr>
<td>EVTYPE</td>
<td>Weather event type.</td>
</tr>
<tr>
<td>FATALITIES</td>
<td>Number of fatalities from this weather event.</td>
</tr>
<tr>
<td>INJURIES</td>
<td>Number of injuries from this weather event.</td>
</tr>
<tr>
<td>PROPDMG</td>
<td>US$ amount of property damage caused by this weather event.</td>
</tr>
<tr>
<td>PROPDMGEXP</td>
<td>Multiplier for the column PROPDMG.</td>
</tr>
<tr>
<td>CROPDMG</td>
<td>US$ amount of crop damage caused by this weather event.</td>
</tr>
<tr>
<td>CROPDMGEXP</td>
<td>Multiplier for the column CROPDMG.</td>
</tr>
</tbody></table>

<h4>2.2 Tidy data - column EVTYPE</h4>

<p>The first column we are interested in is the column EVTYPE. The official permitted storm data events are mentioned in the <a href="https://d396qusza40orc.cloudfront.net/repdata%2Fpeer2_doc%2Fpd01016005curr.pdf">Storm Data Documentation</a>, section 2.1 and shown on table 2.1.1 &ldquo;Storm Data Event Table&rdquo;. Many entries in column EVTYPE look very different from this 48 categories, in fact there are 985 distinct categories given. Below are a couple of changes to this  data which brings the entries much closer to the given set of permitted entries and narrows the categories down to 619. There are still some entries which don&#39;t fall into the bucket of 48, but looking at the event frequency, as they are very small, we keep them in there without collapsing into other major categories.</p>

<pre><code class="r">length(unique(storm$EVTYPE))                                  # 985 categories to start with
</code></pre>

<pre><code>## [1] 985
</code></pre>

<pre><code class="r">storm$EVTYPE &lt;- toupper(storm$EVTYPE)                         # change all entries to upper case
storm$EVTYPE &lt;- gsub(&quot;[\\./-]&quot;, &quot; &quot;, storm$EVTYPE)            # remove . and -
storm$EVTYPE &lt;- gsub(&quot; +&quot;, &quot; &quot;, storm$EVTYPE)                 # remove multiple blanks with single blank
storm$EVTYPE &lt;- gsub(&quot;^ &quot;, &quot;&quot;, storm$EVTYPE)                  # remove any blanks at start
storm$EVTYPE &lt;- gsub(&quot;[0-9]&quot;, &quot;&quot;, storm$EVTYPE)               # remove any numbers
storm$EVTYPE &lt;- gsub(&quot;[\\(\\)]&quot;, &quot;&quot;, storm$EVTYPE)            # remove any open and closing round brackets ()
storm$EVTYPE &lt;- gsub(&quot; $&quot;, &quot;&quot;, storm$EVTYPE)                  # remove any trailing blanks
</code></pre>

<p>This first clean up leaves us with 725 categories.</p>

<pre><code class="r">length(unique(storm$EVTYPE))                                  # 725 categories
</code></pre>

<pre><code>## [1] 725
</code></pre>

<p>A further view on the 725 entries showed that some category names are entered in a different way then the official permitted names and hence we clean up this as well. The entries in the permitted table never use plural (e. g. Flood instead of Floods), so this is changed below:</p>

<pre><code class="r">storm$EVTYPE &lt;- gsub(&quot;FLOOD[A-Z]*&quot;, &quot;FLOOD&quot;, storm$EVTYPE)
storm$EVTYPE &lt;- gsub(&quot;WIND[S]*&quot;, &quot;WIND&quot;, storm$EVTYPE)
storm$EVTYPE &lt;- gsub(&quot;RAINS&quot;, &quot;RAIN&quot;, storm$EVTYPE)
storm$EVTYPE &lt;- gsub(&quot;LANDSLIDES&quot;, &quot;LANDSLIDE&quot;, storm$EVTYPE)
storm$EVTYPE &lt;- gsub(&quot;MUD SLIDE&quot;, &quot;MUDSLIDE&quot;, storm$EVTYPE)
storm$EVTYPE &lt;- gsub(&quot;MUDSLIDES&quot;, &quot;MUDSLIDE&quot;, storm$EVTYPE)
storm$EVTYPE &lt;- gsub(&quot;CURRENTS&quot;, &quot;CURRENT&quot;, storm$EVTYPE)
storm$EVTYPE &lt;- gsub(&quot;THUNDERSTORMS&quot;, &quot;THUNDERSTORM&quot;, storm$EVTYPE)
storm$EVTYPE &lt;- gsub(&quot;SQUALLS&quot;, &quot;SQUALL&quot;, storm$EVTYPE)
storm$EVTYPE &lt;- gsub(&quot;TORNADOS&quot;, &quot;TORNADO&quot;, storm$EVTYPE)
storm$EVTYPE &lt;- gsub(&quot;WILDFIRES&quot;, &quot;WILDFIRE&quot;, storm$EVTYPE)
storm$EVTYPE &lt;- gsub(&quot;WAVES&quot;, &quot;WAVE&quot;, storm$EVTYPE)
</code></pre>

<p>This second clean up results to 671 categories.</p>

<pre><code class="r">length(unique(storm$EVTYPE))                                  # 671 categories
</code></pre>

<pre><code>## [1] 671
</code></pre>

<p>As some of the main categories have been entered in a different way, the EVTYPE on them also get&#39;s changed. First we find out the significance of the wronly entered data and sum the frequency of this event types.</p>

<pre><code class="r">g0 &lt;- group_by(storm, EVTYPE)                                 # group storm database by event type
e0 &lt;- summarize(g0, freq = n())                               # count the event types
e0 &lt;- filter(e0, freq &gt; 10)                                   # show events with a frequency larger than 10
print(e0[20:30,])                                             # display the entires 20 to 30
</code></pre>

<pre><code>## Source: local data frame [11 x 2]
## 
##                            EVTYPE  freq
## 1                    EXTREME HEAT    22
## 2               EXTREME WINDCHILL   204
## 3  EXTREME WINDCHILL TEMPERATURES    19
## 4                     FLASH FLOOD 54993
## 5               FLASH FLOOD FLOOD    32
## 6                           FLOOD 25450
## 7               FLOOD FLASH FLOOD   628
## 8                             FOG   538
## 9                          FREEZE    76
## 10               FREEZING DRIZZLE    24
## 11                   FREEZING FOG    46
</code></pre>

<p>(Frequeny &gt; 10 was only set to emphasise on the example, further analysis will consider all frequencies.)</p>

<p>There are still some entries with higer occurance which fall into separate categories (e. g. &ldquo;FLASH FLOOD FLOOD&rdquo;&ldquo;, &quot;FLOOD FLASH FLOOD&rdquo; which should be both in FLASH FLOOD) and would screw the analysis in a more or less significant way. We combine them into the official category name and this leads to the following &#39;fixes&#39;:</p>

<pre><code class="r">storm$EVTYPE &lt;- gsub(&quot;FLOOD FLASH FLOOD&quot;, &quot;FLASH FLOOD&quot;, storm$EVTYPE)      # combine the &#39;FLOOD FLASH FLOOD&#39; category with &#39;FLASH FLOOD&#39;
storm$EVTYPE &lt;- gsub(&quot;PRECIPITATION&quot;, &quot;PRECIP&quot;, storm$EVTYPE)               # use the short name for precipitation
storm$EVTYPE &lt;- gsub(&quot;TORNADO F&quot;, &quot;TORNADO&quot;, storm$EVTYPE)                  #
storm$EVTYPE &lt;- gsub(&quot;HEAT WAVE&quot;, &quot;HEAT&quot;, storm$EVTYPE)
storm$EVTYPE &lt;- gsub(&quot;HURRICANE.*&quot;, &quot;HURRICANE&quot;, storm$EVTYPE)              # combine any specific hurricane with the overall group
storm$EVTYPE &lt;- gsub(&quot;HURRICANE&quot;, &quot;HURRICANE TYPHOON&quot;, storm$EVTYPE)        # set the official permitted name &#39;HURRICANE (TYPHOONE) but omit the brackets.
storm$EVTYPE &lt;- gsub(&quot;STORM SURGE TIDE&quot;, &quot;STORM SURGE&quot;, storm$EVTYPE)       # combine storm surge and storm tide in one category
storm$EVTYPE &lt;- gsub(&quot;.*THUNDERSTORM WIND.*&quot;, &quot;THUNDERSTORM WIND&quot;, storm$EVTYPE) # 
storm$EVTYPE &lt;- gsub(&quot;TSTM.*&quot;, &quot;THUNDERSTORM WIND&quot;, storm$EVTYPE)           # combine TSTM with THUNDERSTORM WIND
storm$EVTYPE &lt;- gsub(&quot;TROPICAL STORM.*&quot;, &quot;TROPICAL STORM&quot;, storm$EVTYPE)    # use official permitted name
storm$EVTYPE &lt;- gsub(&quot;WILD.*FIRE.*&quot;, &quot;WILDFIRE&quot;, storm$EVTYPE)              # use official permitted name
</code></pre>

<p>The category TSTM could be &#39;Thunder Storm/Wind&#39; or &#39;Tropical Storm/Wind&#39;, which both are separate permitted event categories. It was decided to combine it with the category &#39;Thunderstrom Wind&#39; as a quick Google check showed that TSTM is usually the abbrevation for Thunderstorm. It was also assumed that they are not marine as it would else fall into categor &#39;Marine Thunderstorm Wind&#39;.</p>

<p>This third clean up results to 618 categories.</p>

<pre><code class="r">length(unique(storm$EVTYPE))                                  # 618 categories
</code></pre>

<pre><code>## [1] 618
</code></pre>

<h4>2.3 Tidy data - columns PROPDMGEXP and CROPDMGEXP</h4>

<p>Columns PROPDMGEXP and CROPDMGEXP contain the exponent for the property and crop damage figures. They contain upper and lower case characters for thousands (M) and millions (K), which will be all changed to upper case.</p>

<pre><code class="r">unique(storm$PROPDMGEXP)                                      # show current entries for property damage exponent
</code></pre>

<pre><code>##  [1] K M   B m + 0 5 6 ? 4 2 3 h 7 H - 1 8
## Levels:  - ? + 0 1 2 3 4 5 6 7 8 B h H K m M
</code></pre>

<pre><code class="r">unique(storm$CROPDMGEXP)                                      # show current entries for cromp damage exponent
</code></pre>

<pre><code>## [1]   M K m B ? 0 k 2
## Levels:  ? 0 2 B k K m M
</code></pre>

<pre><code class="r">storm$PROPDMGEXP &lt;- toupper(storm$PROPDMGEXP)                 # change to upper case
storm$CROPDMGEXP &lt;- toupper(storm$CROPDMGEXP)                 # change to upper case
</code></pre>

<p>Further they have numbers and question marks in them. To remove this entries we define a simple function &#39;multiplier&#39; which sets all entries to the actual multiplier: H = 100 (hundreds), K = 1,000 (thousands), M = 1,000,000 (millions), B = 1,000,000,000 (billions), 1 will be the default multiplier for any other entries.</p>

<pre><code class="r">multiplier &lt;- function(x) { 
  m = 1
  if (x == &quot;H&quot;) {
    m = 10
  }
  if (x == &quot;K&quot;) {
    m = 10^3
  }
  if (x == &quot;M&quot;) {
    m = 10^6
  }
  if (x == &quot;B&quot;) {
    m = 10^9
  }
  m
}
storm &lt;- mutate(storm, mult_PD_EXP = PROPDMGEXP)                  # create the new columns
storm &lt;- mutate(storm, mult_CD_EXP = CROPDMGEXP)

storm$mult_PD_EXP &lt;- sapply(storm$PROPDMGEXP, FUN=&quot;multiplier&quot;)   # calculate numeric multiplier from characters in column PROPDMGEXP
storm$mult_CD_EXP &lt;- sapply(storm$CROPDMGEXP, FUN=&quot;multiplier&quot;)   # calculate numeric multiplier from characters in column CROPDMGEXP
</code></pre>

<p>There are now the appropriate multiplier numbers in the fields &#39;mult_PD_EXP&#39; and &#39;mult_CD_EXP&#39;.</p>

<pre><code class="r">format(unique(storm$mult_PD_EXP), scientific=F)                   # show current entries for property damage exponent
</code></pre>

<pre><code>## [1] &quot;      1000&quot; &quot;   1000000&quot; &quot;         1&quot; &quot;1000000000&quot; &quot;        10&quot;
</code></pre>

<pre><code class="r">format(unique(storm$mult_CD_EXP), scientific=F)                   # show current entries for crop damage exponent
</code></pre>

<pre><code>## [1] &quot;         1&quot; &quot;   1000000&quot; &quot;      1000&quot; &quot;1000000000&quot;
</code></pre>

<p>At this stage we can now calculate the damage for the property and crop columns which we store in a new column called &#39;damage&#39;. The total damage is the </p>

<p><strong>damage</strong> = <strong>property damage</strong> * <em>mulitplier for property damage</em>** + <strong>crop damage</strong> * <em>multiplier for crop damage</em>**</p>

<pre><code class="r">storm &lt;- mutate(storm, damage = PROPDMG * mult_PD_EXP + CROPDMG * mult_CD_EXP)   # calculate total damage and create new column
</code></pre>

<h3>3. Results</h3>

<p>Now we can tackle the originally raised questions. First the most harmful events, let&#39;s repeat the question:</p>

<p><em>Across the United States, which types of events (as indicated in the EVTYPE variable) are most harmful with respect to population health?</em></p>

<p>As we are looking at most harmful events with respect to population, the two columns FATALITIES and INJURIES are relevant. We will handle and display them separately.</p>

<h4>3.1 Injuries</h4>

<p>First the total number of injuries per event type is calculated and aggregated below.</p>

<pre><code class="r">g_i &lt;- group_by(storm, EVTYPE)                                    # group by event type
inj_evt &lt;- summarize(g_i, injuries = sum(INJURIES/1000))          # calculate the sum of injuries in thousands
inj_evt_high &lt;- filter(inj_evt, injuries &gt; 1)                     # filter only events with more than 1000 injuries
inj_evt_high$EVTYPE &lt;- reorder(inj_evt_high$EVTYPE, -inj_evt_high$injuries)   # reorder the events by frequency
</code></pre>

<p>The following is a graphical representation of the total amount of inuries per weather event and shows that the category tornado is by far the one with highest injuries. After that in close succession follow the categories &#39;thunderstorm wind&#39;, flood, &#39;excessive heat&#39; and lightning.</p>

<pre><code class="r">cc &lt;- length(inj_evt_high$EVTYPE)                                 # get the number of total event types
palette &lt;- colorRampPalette(rev(brewer.pal(9, &quot;Greys&quot;)))          # match the color palette grey shapes
                                                                  # display the data in a plot
ggplot(inj_evt_high) + geom_bar(stat=&quot;identity&quot;, aes(EVTYPE, injuries), fill=palette(cc)) + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) + ggtitle(&quot;Injuries Per Event Type\n&quot;) + xlab(&quot;Weather Event Type&quot;) + ylab(&quot;Injuries in thousands&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-17"/> </p>

<p>The actual figures are shown below where tornado as cause for injuries are standing out the most.</p>

<pre><code class="r">head(arrange(inj_evt_high, desc(injuries)), 10)                   # list the events with highest injuries
</code></pre>

<pre><code>## Source: local data frame [10 x 2]
## 
##               EVTYPE injuries
## 1            TORNADO   91.364
## 2  THUNDERSTORM WIND    9.495
## 3              FLOOD    6.791
## 4     EXCESSIVE HEAT    6.525
## 5          LIGHTNING    5.230
## 6               HEAT    2.479
## 7          ICE STORM    1.975
## 8        FLASH FLOOD    1.800
## 9           WILDFIRE    1.606
## 10         HIGH WIND    1.440
</code></pre>

<h4>3.2 Fatalities</h4>

<p>Secondly the total number of fatalities per event type is calculated and aggregated below.</p>

<pre><code class="r">g_f &lt;- group_by(storm, EVTYPE)                                    # group by event type
fat_evt &lt;- summarize(g_f, fatalities = sum(FATALITIES))           # calculate the sum of injuries
fat_evt_high &lt;- filter(fat_evt, fatalities &gt; 200)                 # filter only events with more than 200 fatalities
fat_evt_high$EVTYPE &lt;- reorder(fat_evt_high$EVTYPE, -fat_evt_high$fatalities)   # reorder the events by frequency
</code></pre>

<p>The graph below shows the total amount of fatalities per weather event and depicts that again tornado is by far the category with the most fatalities. Then the category &#39;exessive heat&#39; followed by heat, flash flood, lightning and &#39;thunderstorm wind&#39; in fairly close succession.</p>

<pre><code class="r">cc &lt;- length(fat_evt_high$EVTYPE)                                 # get the number of total event types
palette &lt;- colorRampPalette(rev(brewer.pal(9, &quot;Greys&quot;)))          # match the color palette grey shapes
                                                                  # display the data in a plot
ggplot(fat_evt_high) + geom_bar(stat=&quot;identity&quot;, aes(EVTYPE, fatalities), fill=palette(cc)) + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) + ggtitle(&quot;Fatalities Per Event Type\n&quot;) + xlab(&quot;Weather Event Type&quot;) + ylab(&quot;Fatalities&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-20"/> </p>

<p>The actual figures are shown below where again tornado is the most deadliest cause for fatalities on weather events.</p>

<pre><code class="r">head(arrange(fat_evt_high, desc(fatalities)), 10)                 # list the events with highest fatilities
</code></pre>

<pre><code>## Source: local data frame [10 x 2]
## 
##               EVTYPE fatalities
## 1            TORNADO       5633
## 2     EXCESSIVE HEAT       1903
## 3               HEAT       1114
## 4        FLASH FLOOD       1016
## 5          LIGHTNING        817
## 6  THUNDERSTORM WIND        719
## 7        RIP CURRENT        572
## 8              FLOOD        476
## 9          HIGH WIND        283
## 10         AVALANCHE        224
</code></pre>

<h4>3.3 Most harmful economic events</h4>

<p>The second question which we want to answer is as follows:</p>

<p><em>Across the United States, which types of events have the greatest economic consequences?</em></p>

<p>The storm database gives two columns &#39;PROPDMG&#39; and &#39;CROPDMG&#39; which we already combined in section 2.3 to a single column called &#39;damage&#39;. </p>

<p>When viewing this data and ordering by most significant damages it appears that one outlier was found which has a multiplier of &#39;B&#39; (billion) in column PROPDMGEXP which must have been a mistake.</p>

<pre><code class="r">options(scipen=999)                                              # don&#39;t use scientific notation
                                                                 # arrange by damage, decending
head(storm %&gt;% select(REFNUM, PROPDMGEXP, CROPDMGEXP, damage) %&gt;% arrange(desc(damage)), 10)
</code></pre>

<pre><code>##    REFNUM PROPDMGEXP CROPDMGEXP       damage
## 1  605943          B          M 115032500000
## 2  577616          B             31300000000
## 3  577615          B             16930000000
## 4  581535          B             11260000000
## 5  198375          B          B  10000000000
## 6  569288          B             10000000000
## 7  581537          B          B   7390000000
## 8  581533          B              7350000000
## 9  529299          B          M   5705000000
## 10 444407          B              5150000000
</code></pre>

<p>According to the details in column REMARK the damage is in millions rather than billions. As this is a significant difference and changes the end amount a lot it will be manually fixed.</p>

<pre><code class="r">subset(storm, REFNUM==605943, select=c(8,2,37,40,26,28))         # show the entry with wrong property multiplier
</code></pre>

<pre><code>##        EVTYPE         BGN_DATE REFNUM       damage PROPDMGEXP CROPDMGEXP
## 605953  FLOOD 1/1/2006 0:00:00 605943 115032500000          B          M
</code></pre>

<pre><code class="r">subset(storm, REFNUM==605943, select=c(37,36))                   # show the comment which mentions damages in millions rather than billions
</code></pre>

<pre><code>##        REFNUM
## 605953 605943
##                                                                                                                                                                                                                                                                                                                                                                                               REMARKS
## 605953 Major flooding continued into the early hours of January 1st, before the Napa River finally fell below flood stage and the water receeded. Flooding was severe in Downtown Napa from the Napa Creek and the City and Parks Department was hit with $6 million in damage alone. The City of Napa had 600 homes with moderate damage, 150 damaged businesses with costs of at least $70 million.
</code></pre>

<pre><code class="r">storm[storm$REFNUM==605943,40] &lt;- 147500000                      # fix the data
</code></pre>

<p>We can now sum the damages and aggregate as follows.</p>

<pre><code class="r">g_d &lt;- group_by(storm, EVTYPE)                                   # group by event type
dam_evt &lt;- summarize(g_d, damages = sum(damage/1000000000))      # sum all damages and convert to billions
dam_evt_high &lt;- filter(dam_evt, damages &gt; 5)                     # filter out events with damages below 5
dam_evt_high$EVTYPE &lt;- reorder(dam_evt_high$EVTYPE, -dam_evt_high$damages)    # reorder the event type
</code></pre>

<p>It is assumed that the economic figures from this storm database are already adjusted for inflation and normalized.
Displaying the data in a graph clearly shows that category &#39;hurrican typhoon&#39; is the most harmful economic event followed by tornado, &#39;storm surge&#39; and flood.</p>

<pre><code class="r">cc &lt;- length(dam_evt_high$EVTYPE)                                # get the number of total event types
palette &lt;- colorRampPalette(rev(brewer.pal(9, &quot;Greys&quot;)))         # match the color palette grey shapes
                                                                 # display the data in a plot
ggplot(dam_evt_high) + geom_bar(stat=&quot;identity&quot;, aes(EVTYPE, damages), fill=palette(cc)) + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) + ggtitle(&quot;Damages Per Event Type\n&quot;) + xlab(&quot;Weather Event Type&quot;) + ylab(&quot;Damages (Billion US$)&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-25"/> </p>

<p>The actual data looks like this:</p>

<pre><code class="r">head(arrange(dam_evt_high, desc(damages)), 10)                   # list the events with highest damage
</code></pre>

<pre><code>## Source: local data frame [10 x 2]
## 
##               EVTYPE   damages
## 1  HURRICANE TYPHOON 90.271473
## 2            TORNADO 57.356892
## 3        STORM SURGE 47.965579
## 4              FLOOD 35.557839
## 5               HAIL 18.758863
## 6        FLASH FLOOD 18.163370
## 7            DROUGHT 15.018672
## 8  THUNDERSTORM WIND 11.015195
## 9        RIVER FLOOD 10.292723
## 10         ICE STORM  8.967041
</code></pre>

<p>It is to note from the detailed documents that major catastrophic events are actually not just counted in one category. For example hurricane &#39;Katrina&#39; was counted in at least two categories as shown below. This is because events spread out over a couple of days and can cause follow on effects which are registered separately.</p>

<pre><code class="r">subset(storm, REFNUM==577616 | REFNUM==577615, select=c(8,2,37,38,40))   # show the Katrina events is spread over two entries
</code></pre>

<pre><code>##                   EVTYPE          BGN_DATE REFNUM mult_PD_EXP      damage
## 577675 HURRICANE TYPHOON 8/28/2005 0:00:00 577615  1000000000 16930000000
## 577676       STORM SURGE 8/29/2005 0:00:00 577616  1000000000 31300000000
</code></pre>

</body>

</html>
